---
title: "p8105_hw3_jer2243"
author: "Juliet Rowe"
date: "2023-10-09"
output: github_document
---


# Problem 2

## Load packages and BRFSS data
```{r}
library(tidyverse)
library(dplyr)
library(ggplot2)
library(p8105.datasets)
data("brfss_smart2010")
```


## Clean BRFSS data
```{r}
levels <- c("Poor", "Fair", "Good", "Very good", "Excellent")
values <- c(1, 2, 3, 4, 5)

brfss_smart2010_tidy = brfss_smart2010 |>
  janitor::clean_names() |>
  filter(topic == "Overall Health") |>
  transform(response = factor(response, levels = levels, labels = values, ordered = TRUE))
  
```


## In 2002, which states were observed at 7 or more locations? What about in 2010?
```{r}
brfss_2002 <- brfss_smart2010_tidy |>
  filter(year==2002)

result <- brfss_2002 |>
  group_by(locationabbr) |>
  summarise(unique_locationdesc = n_distinct(locationdesc)) |>
  filter(unique_locationdesc > 7)

print(result)

brfss_2010 <- brfss_smart2010_tidy |>
  filter(year==2010)

result <- brfss_2010 |>
  group_by(locationabbr) |>
  summarise(unique_locationdesc = n_distinct(locationdesc)) |>
  filter(unique_locationdesc > 7)

print(result)
```
3 states in 2002 were observed at 7 or more locations (MA, NJ, PA). 11 states in 2010 were observed at 7 or more locations (CA, FL, MA, MD, NC, NE, NJ, NY, OH, TX, WA).


## Construct a dataset limited to "excellent" responses
```{r}
brfss_excellent = brfss_smart2010_tidy |>
  filter(response == "5") |>
  group_by(locationabbr) |>
  mutate(data_value_avg = mean(data_value, na.rm = TRUE)) |>
  select(year, locationabbr, data_value_avg)
  
```


## Spaghetti plot of the avg value over time within a state
```{r}
ggplot(brfss_excellent, aes(x=year, y=data_value_avg, color=locationabbr, group=locationabbr)) + 
  geom_line() +
  labs(x="Year", y="Average Data Value", color = "State") +
  ggtitle("Average Data Value by State over Years")
```
ADD COMMENTS HERE

## Two-panel plot
```{r}
ny_data <- brfss_smart2010_tidy |>
  filter(locationabbr == "NY" & year %in% c(2006, 2010))

ggplot(ny_data, aes(x = data_value, fill = response)) +
  geom_histogram(binwidth = 6, position = "dodge") +
  facet_wrap(~ year, nrow = 1) +
  labs(x = "Data Value", y = "Frequency", fill = "Response") +
  ggtitle("Distribution of Data Value by Response in NY State")
```
ADD COMMENTS HERE


# Problem 3


## Import and clean demographic and accelerometer data
```{r}
demo_data = read_csv(file = "~/Desktop/p8105_hw3_jer2243/nhanes_covar.csv", skip=4) |>
  janitor::clean_names()

accel_data = read_csv(file = "~/Desktop/p8105_hw3_jer2243/nhanes_accel.csv") |>
  janitor::clean_names()
```


## Clean the demo dataset
```{r}
demo_data <- subset(demo_data, age>=21)
demo_data <- demo_data[complete.cases(demo_data), ]
```


## Merge demo dataset with accel dataset
```{r}
merged_data = 
  left_join(demo_data, accel_data, by = "seqn")
```


## Encode data with reasonable variable classes

```{r}

```

